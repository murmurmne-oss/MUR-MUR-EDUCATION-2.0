# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ API key** –¥–ª—è –≤—Å–µ—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö endpoints
2. **–ó–∞—â–∏—â–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤** - —Ç–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É–µ—Ç API key
3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω CORS** - –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã
4. **–°–æ–∑–¥–∞–Ω –ø—Ä–æ–∫—Å–∏-—Ä–æ—É—Ç** –≤ –∞–¥–º–∏–Ω–∫–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ API key

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. Backend (.env)

–î–æ–±–∞–≤—å—Ç–µ –≤ `deploy/.env`:

```env
# API –∫–ª—é—á –¥–ª—è –∑–∞—â–∏—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö endpoints
API_KEY=your-super-secret-api-key-here-min-32-chars

# CORS - —É–∫–∞–∂–∏—Ç–µ –¥–æ–º–µ–Ω—ã, —Å –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∑–∞–ø—Ä–æ—Å—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
CORS_ORIGIN=https://admin.murmurmne.com,https://murmurmne.com
```

**–í–∞–∂–Ω–æ:** 
- `API_KEY` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–ª–∏–Ω–Ω—ã–º —Å–ª—É—á–∞–π–Ω—ã–º —Å—Ç—Ä–æ–∫–æ–π (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ `CORS_ORIGIN` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω —è–≤–Ω–æ, –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `*`

### 2. Admin Panel (.env)

–î–æ–±–∞–≤—å—Ç–µ –≤ `deploy/.env` (–∏–ª–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∞–¥–º–∏–Ω–∫–∏):

```env
# –¢–æ—Ç –∂–µ API –∫–ª—é—á, —á—Ç–æ –∏ –≤ backend
API_KEY=your-super-secret-api-key-here-min-32-chars
```

**–í–∞–∂–Ω–æ:** 
- `API_KEY` –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–µ–º, —á—Ç–æ –≤ backend
- –≠—Ç–æ —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –ù–ï `NEXT_PUBLIC_*`

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ API –∫–ª—é—á–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–ª—é—á–∞ (64 —Å–∏–º–≤–æ–ª–∞)
openssl rand -hex 32
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä: https://randomkeygen.com/

## üìã –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints

–°–ª–µ–¥—É—é—â–∏–µ endpoints —Ç–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É—é—Ç API key:

### Courses
- `POST /courses` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫—É—Ä—Å–∞
- `PUT /courses/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞
- `DELETE /courses/:id` - —É–¥–∞–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞
- `GET /courses/:id/access-codes` - —Å–ø–∏—Å–æ–∫ –∫–æ–¥–æ–≤ –¥–æ—Å—Ç—É–ø–∞
- `POST /courses/:id/access-codes` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –¥–æ—Å—Ç—É–ø–∞

### Users
- `GET /users` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /users/:id` - –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /users/:id/reminder` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π

### Analytics
- `GET /analytics/overview` - –æ–±–∑–æ—Ä
- `GET /analytics/top-courses` - —Ç–æ–ø –∫—É—Ä—Å–æ–≤
- `GET /analytics/activity` - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### Uploads
- `POST /uploads/images` - –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üîí –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Backend** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-API-Key` –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º endpoints
2. **Admin Panel** –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏-—Ä–æ—É—Ç `/api/proxy/*`, –∫–æ—Ç–æ—Ä—ã–π:
   - –î–æ–±–∞–≤–ª—è–µ—Ç API key –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
   - –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ backend API
3. **CORS** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ API_KEY –≤ git** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` —Ñ–∞–π–ª—ã
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏** –¥–ª—è dev –∏ production
3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ –∫–ª—é—á–∏** –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

## üöÄ –î–µ–ø–ª–æ–π

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `.env` —Ñ–∞–π–ª–æ–≤:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /path/to/tg-miniapp-bot
git pull
cd deploy

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Å –Ω–æ–≤—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
docker compose -f docker-compose.prod.yml build --no-cache backend admin
docker compose -f docker-compose.prod.yml up -d backend admin
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. –ê–¥–º–∏–Ω–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç)
2. –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ API –±–µ–∑ –∫–ª—é—á–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401:
   ```bash
   curl -X POST https://api.murmurmne.com/courses
   # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: {"message":"–ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π API –∫–ª—é—á"}
   ```
3. –ó–∞–ø—Ä–æ—Å —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∫–ª—é—á–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç:
   ```bash
   curl -X POST https://api.murmurmne.com/courses \
     -H "X-API-Key: your-api-key" \
     -H "Content-Type: application/json"
   ```

## üîê –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—É—Ç–∏ –∞–¥–º–∏–Ω–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å –ø—É—Ç—å –∞–¥–º–∏–Ω–∫–∏ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/admin-xyz123` –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ):

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Nginx (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx –¥–æ–±–∞–≤—å—Ç–µ:

```nginx
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—É—Ç—å - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π
location = /admin {
    return 301 /admin-xyz123;
}

# –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –ø—É—Ç—å
location /admin-xyz123 {
    proxy_pass http://admin:3000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Next.js basePath

–í `apps/admin/next.config.ts` –¥–æ–±–∞–≤—å—Ç–µ:

```typescript
const nextConfig = {
  basePath: '/admin-xyz123',
  // ...
};
```

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è basePath –≤—Å–µ —Å—Å—ã–ª–∫–∏ –≤ –∞–¥–º–∏–Ω–∫–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –ø—É—Ç—å.

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Nginx, —Ç–∞–∫ –∫–∞–∫:
- –ù–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—Ç—å –∞–¥–º–∏–Ω–∫—É
- –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø—É—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
- –ú–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å –æ—Ç —Å–∫–∞–Ω–µ—Ä–æ–≤

